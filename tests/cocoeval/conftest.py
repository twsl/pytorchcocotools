from pycocotools.coco import COCO as COCOnp  # noqa: N811
from pycocotools.cocoeval import COCOeval as COCOevalnp  # noqa: N811
from pytest_cases import fixture

from pytorchcocotools.coco import COCO as COCOpt  # noqa: N811
from pytorchcocotools.cocoeval import COCOeval as COCOevalpt
from pytorchcocotools.internal.structure.coco import CocoDetectionDataset  # noqa: N811

# Datasets


@fixture(scope="session")
def dataset_object_gt() -> dict:
    return {
        "annotations": [
            {
                "id": 1,
                "image_id": 1,
                "category_id": 1,
                "bbox": [0, 0, 10, 10],
                "area": 100,
                "iscrowd": 0,
                "segmentation": [[10, 10, 30, 10, 30, 30, 10, 30]],
            },
            {
                "id": 2,
                "image_id": 1,
                "category_id": 2,
                "bbox": [10, 10, 20, 20],
                "area": 100,
                "iscrowd": 0,
                "segmentation": [[10, 10, 30, 10, 30, 30, 10, 30]],
            },
            {
                "id": 3,
                "image_id": 2,
                "category_id": 2,
                "bbox": [5, 5, 15, 15],
                "area": 100,
                "iscrowd": 0,
                "segmentation": [[10, 10, 25, 15, 30, 35, 10, 30]],
            },
            # realistic example uncompressed
            # {
            #     "id": 4,
            #     "image_id": 3,
            #     "category_id": 3,
            #     "num_keypoints": 0,
            #     "segmentation": {
            #         "counts": [
            #             39931,
            #             6,
            #             421,
            #             8,
            #             419,
            #             10,
            #             417,
            #             12,
            #             416,
            #             12,
            #             44,
            #             18,
            #             354,
            #             12,
            #             43,
            #             20,
            #             353,
            #             12,
            #             42,
            #             22,
            #             352,
            #             12,
            #             41,
            #             24,
            #             351,
            #             12,
            #             41,
            #             24,
            #             351,
            #             12,
            #             41,
            #             24,
            #             352,
            #             10,
            #             26,
            #             6,
            #             10,
            #             24,
            #             353,
            #             8,
            #             26,
            #             8,
            #             9,
            #             24,
            #             355,
            #             4,
            #             27,
            #             10,
            #             5,
            #             27,
            #             386,
            #             11,
            #             3,
            #             3,
            #             3,
            #             22,
            #             386,
            #             11,
            #             2,
            #             4,
            #             3,
            #             21,
            #             387,
            #             11,
            #             1,
            #             5,
            #             3,
            #             20,
            #             388,
            #             11,
            #             1,
            #             5,
            #             3,
            #             21,
            #             354,
            #             6,
            #             1,
            #             6,
            #             20,
            #             11,
            #             1,
            #             6,
            #             14,
            #             9,
            #             353,
            #             15,
            #             19,
            #             11,
            #             1,
            #             6,
            #             375,
            #             17,
            #             18,
            #             11,
            #             1,
            #             29,
            #             351,
            #             2,
            #             10,
            #             7,
            #             17,
            #             11,
            #             1,
            #             29,
            #             351,
            #             2,
            #             34,
            #             11,
            #             1,
            #             29,
            #             351,
            #             2,
            #             34,
            #             11,
            #             1,
            #             29,
            #             351,
            #             8,
            #             28,
            #             11,
            #             1,
            #             28,
            #             352,
            #             19,
            #             17,
            #             11,
            #             1,
            #             27,
            #             353,
            #             19,
            #             17,
            #             10,
            #             2,
            #             27,
            #             353,
            #             20,
            #             16,
            #             9,
            #             3,
            #             27,
            #             354,
            #             19,
            #             16,
            #             9,
            #             3,
            #             27,
            #             1,
            #             1,
            #             352,
            #             10,
            #             8,
            #             1,
            #             15,
            #             1,
            #             3,
            #             5,
            #             3,
            #             28,
            #             1,
            #             5,
            #             348,
            #             9,
            #             9,
            #             1,
            #             26,
            #             29,
            #             1,
            #             18,
            #             335,
            #             9,
            #             9,
            #             1,
            #             4,
            #             18,
            #             4,
            #             28,
            #             2,
            #             18,
            #             335,
            #             9,
            #             9,
            #             1,
            #             4,
            #             19,
            #             3,
            #             28,
            #             2,
            #             18,
            #             335,
            #             9,
            #             9,
            #             1,
            #             4,
            #             19,
            #             3,
            #             28,
            #             2,
            #             18,
            #             336,
            #             8,
            #             14,
            #             19,
            #             3,
            #             28,
            #             2,
            #             1,
            #             11,
            #             6,
            #             336,
            #             8,
            #             14,
            #             19,
            #             3,
            #             28,
            #             355,
            #             8,
            #             15,
            #             19,
            #             3,
            #             28,
            #             355,
            #             8,
            #             15,
            #             3,
            #             8,
            #             8,
            #             3,
            #             28,
            #             355,
            #             12,
            #             12,
            #             1,
            #             21,
            #             27,
            #             2,
            #             7,
            #             346,
            #             15,
            #             32,
            #             25,
            #             2,
            #             15,
            #             339,
            #             16,
            #             11,
            #             4,
            #             1,
            #             8,
            #             9,
            #             22,
            #             2,
            #             17,
            #             338,
            #             17,
            #             17,
            #             4,
            #             15,
            #             18,
            #             2,
            #             17,
            #             338,
            #             18,
            #             27,
            #             1,
            #             10,
            #             15,
            #             2,
            #             17,
            #             339,
            #             17,
            #             27,
            #             5,
            #             10,
            #             10,
            #             3,
            #             17,
            #             339,
            #             17,
            #             27,
            #             9,
            #             9,
            #             6,
            #             4,
            #             17,
            #             339,
            #             17,
            #             27,
            #             14,
            #             8,
            #             2,
            #             4,
            #             17,
            #             339,
            #             17,
            #             28,
            #             18,
            #             9,
            #             17,
            #             339,
            #             17,
            #             29,
            #             22,
            #             5,
            #             15,
            #             340,
            #             17,
            #             31,
            #             21,
            #             5,
            #             13,
            #             341,
            #             16,
            #             33,
            #             20,
            #             7,
            #             4,
            #             1,
            #             4,
            #             344,
            #             14,
            #             34,
            #             20,
            #             361,
            #             11,
            #             36,
            #             20,
            #             363,
            #             4,
            #             41,
            #             20,
            #             409,
            #             18,
            #             411,
            #             16,
            #             414,
            #             4,
            #             1,
            #             7,
            #             68110,
            #             6,
            #             421,
            #             8,
            #             419,
            #             10,
            #             417,
            #             12,
            #             416,
            #             12,
            #             416,
            #             12,
            #             416,
            #             12,
            #             416,
            #             12,
            #             416,
            #             12,
            #             416,
            #             12,
            #             414,
            #             13,
            #             414,
            #             14,
            #             413,
            #             15,
            #             412,
            #             16,
            #             412,
            #             16,
            #             412,
            #             16,
            #             412,
            #             16,
            #             412,
            #             15,
            #             413,
            #             15,
            #             413,
            #             15,
            #             414,
            #             14,
            #             415,
            #             13,
            #             416,
            #             12,
            #             417,
            #             12,
            #             416,
            #             12,
            #             416,
            #             12,
            #             416,
            #             12,
            #             416,
            #             12,
            #             416,
            #             12,
            #             416,
            #             12,
            #             417,
            #             10,
            #             419,
            #             8,
            #             422,
            #             4,
            #             129004,
            #         ],
            #         "size": [428, 640],
            #     },
            #     "area": 3225,
            #     "iscrowd": 1,
            #     "bbox": [93, 123, 245, 133],
            # },
        ],
        "images": [
            {
                "id": 1,
                "height": 50,
                "width": 100,
            },
            {
                "id": 2,
                "height": 50,
                "width": 100,
            },
            {
                "id": 3,
                "height": 640,
                "width": 480,
            },
        ],
        "categories": [{"id": 1}, {"id": 2}, {"id": 3}],
    }


@fixture(scope="session")
def dataset_object_dt() -> dict:
    return {
        "annotations": [
            {
                "id": 1,
                "image_id": 1,
                "category_id": 1,
                "bbox": [0, 0, 10, 10],
                "area": 100,
                "iscrowd": 0,
                "keypoints": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                "num_keypoints": 5,
                "segmentation": [[10, 10, 30, 10, 30, 30, 10, 30]],
                "score": 0.5,
            },
            {
                "id": 2,
                "image_id": 1,
                "category_id": 2,
                "bbox": [10, 10, 15, 15],
                "area": 100,
                "iscrowd": 0,
                "keypoints": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                "num_keypoints": 5,
                "segmentation": [[10, 10, 25, 10, 30, 30, 10, 30]],
                "score": 0.8,
            },
            {
                "id": 3,
                "image_id": 2,
                "category_id": 2,
                "bbox": [5, 5, 12, 12],
                "area": 100,
                "iscrowd": 0,
                "keypoints": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                "num_keypoints": 5,
                "segmentation": [[10, 10, 25, 12, 30, 33, 10, 30]],
                "score": 0.7,
            },
            # realistic example uncompressed
            # {
            #     "id": 4,
            #     "image_id": 3,
            #     "category_id": 3,
            #     "num_keypoints": 0,
            #     "segmentation": {
            #         "counts": [
            #             39931,
            #             6,
            #             421,
            #             8,
            #             419,
            #             10,
            #             417,
            #             15,
            #             416,
            #             15,
            #             44,
            #             18,
            #             354,
            #             12,
            #             43,
            #             20,
            #             353,
            #             12,
            #             42,
            #             22,
            #             352,
            #             12,
            #             41,
            #             24,
            #             351,
            #             12,
            #             41,
            #             24,
            #             351,
            #             12,
            #             41,
            #             24,
            #             352,
            #             10,
            #             26,
            #             6,
            #             10,
            #             24,
            #             353,
            #             8,
            #             26,
            #             8,
            #             9,
            #             24,
            #             355,
            #             4,
            #             27,
            #             10,
            #             5,
            #             27,
            #             386,
            #             11,
            #             3,
            #             3,
            #             3,
            #             22,
            #             386,
            #             11,
            #             2,
            #             4,
            #             3,
            #             21,
            #             387,
            #             11,
            #             1,
            #             5,
            #             3,
            #             20,
            #             388,
            #             11,
            #             1,
            #             5,
            #             3,
            #             21,
            #             354,
            #             6,
            #             1,
            #             6,
            #             20,
            #             11,
            #             1,
            #             6,
            #             14,
            #             9,
            #             353,
            #             15,
            #             19,
            #             11,
            #             1,
            #             6,
            #             375,
            #             17,
            #             18,
            #             11,
            #             1,
            #             29,
            #             351,
            #             2,
            #             10,
            #             7,
            #             17,
            #             11,
            #             1,
            #             29,
            #             351,
            #             2,
            #             34,
            #             11,
            #             1,
            #             29,
            #             351,
            #             2,
            #             34,
            #             11,
            #             1,
            #             29,
            #             351,
            #             8,
            #             28,
            #             11,
            #             1,
            #             28,
            #             352,
            #             19,
            #             17,
            #             11,
            #             1,
            #             27,
            #             353,
            #             19,
            #             17,
            #             10,
            #             2,
            #             27,
            #             353,
            #             20,
            #             16,
            #             9,
            #             3,
            #             27,
            #             354,
            #             19,
            #             16,
            #             9,
            #             3,
            #             27,
            #             1,
            #             1,
            #             352,
            #             10,
            #             8,
            #             1,
            #             15,
            #             1,
            #             3,
            #             5,
            #             3,
            #             28,
            #             1,
            #             5,
            #             348,
            #             9,
            #             9,
            #             1,
            #             26,
            #             29,
            #             1,
            #             18,
            #             335,
            #             9,
            #             9,
            #             1,
            #             4,
            #             18,
            #             4,
            #             28,
            #             2,
            #             18,
            #             335,
            #             9,
            #             9,
            #             1,
            #             4,
            #             19,
            #             3,
            #             28,
            #             2,
            #             18,
            #             335,
            #             9,
            #             9,
            #             1,
            #             4,
            #             19,
            #             3,
            #             28,
            #             2,
            #             18,
            #             336,
            #             8,
            #             14,
            #             19,
            #             3,
            #             28,
            #             2,
            #             1,
            #             11,
            #             6,
            #             336,
            #             8,
            #             14,
            #             19,
            #             3,
            #             28,
            #             355,
            #             8,
            #             15,
            #             19,
            #             3,
            #             28,
            #             355,
            #             8,
            #             15,
            #             3,
            #             8,
            #             8,
            #             3,
            #             28,
            #             355,
            #             12,
            #             12,
            #             1,
            #             21,
            #             27,
            #             2,
            #             7,
            #             346,
            #             15,
            #             32,
            #             25,
            #             2,
            #             15,
            #             339,
            #             16,
            #             11,
            #             4,
            #             1,
            #             8,
            #             9,
            #             22,
            #             2,
            #             17,
            #             338,
            #             17,
            #             17,
            #             4,
            #             15,
            #             18,
            #             2,
            #             17,
            #             338,
            #             18,
            #             27,
            #             1,
            #             10,
            #             15,
            #             2,
            #             17,
            #             339,
            #             17,
            #             27,
            #             5,
            #             10,
            #             10,
            #             3,
            #             17,
            #             339,
            #             17,
            #             27,
            #             9,
            #             9,
            #             6,
            #             4,
            #             17,
            #             339,
            #             17,
            #             27,
            #             14,
            #             8,
            #             2,
            #             4,
            #             17,
            #             339,
            #             17,
            #             28,
            #             18,
            #             9,
            #             17,
            #             339,
            #             17,
            #             29,
            #             22,
            #             5,
            #             15,
            #             340,
            #             17,
            #             31,
            #             21,
            #             5,
            #             13,
            #             341,
            #             16,
            #             33,
            #             20,
            #             7,
            #             4,
            #             1,
            #             4,
            #             344,
            #             14,
            #             34,
            #             20,
            #             361,
            #             11,
            #             36,
            #             20,
            #             363,
            #             4,
            #             41,
            #             20,
            #             409,
            #             18,
            #             411,
            #             16,
            #             414,
            #             4,
            #             1,
            #             7,
            #             68110,
            #             6,
            #             421,
            #             6,
            #             419,
            #             10,
            #             417,
            #             12,
            #             416,
            #             12,
            #             416,
            #             12,
            #             416,
            #             12,
            #             416,
            #             12,
            #             416,
            #             12,
            #             416,
            #             12,
            #             414,
            #             13,
            #             414,
            #             14,
            #             413,
            #             15,
            #             415,
            #             16,
            #             412,
            #             16,
            #             412,
            #             16,
            #             412,
            #             16,
            #             415,
            #             15,
            #             413,
            #             15,
            #             413,
            #             15,
            #             415,
            #             14,
            #             415,
            #             13,
            #             415,
            #             12,
            #             417,
            #             12,
            #             416,
            #             12,
            #             416,
            #             12,
            #             415,
            #             12,
            #             416,
            #             12,
            #             416,
            #             12,
            #             416,
            #             12,
            #             417,
            #             10,
            #             419,
            #             8,
            #             422,
            #             4,
            #             129004,
            #         ],
            #         "size": [428, 640],
            #     },
            #     "area": 3225,
            #     "iscrowd": 1,
            #     "bbox": [93, 125, 245, 135],
            #     "score": 0.8,
            # },
        ],
        "images": [
            {
                "id": 1,
                "height": 50,
                "width": 100,
            },
            {
                "id": 2,
                "height": 50,
                "width": 100,
            },
            {
                "id": 3,
                "height": 640,
                "width": 480,
            },
        ],
        "categories": [{"id": 1}, {"id": 2}, {"id": 3}],
    }


@fixture(scope="session")
def dataset_keypoint_gt() -> dict:
    return {
        "annotations": [
            # realistic example keypoints
            {
                "id": 1,
                "image_id": 1,
                "category_id": 4,
                "segmentation": [
                    [
                        135.17,
                        444.83,
                        113.1,
                        435.17,
                        100.69,
                        439.31,
                        96.55,
                        439.31,
                        75.86,
                        431.03,
                        71.72,
                        428.28,
                        70.34,
                        396.55,
                        64.83,
                        356.55,
                        89.66,
                        338.62,
                        104.83,
                        312.41,
                        126.9,
                        291.72,
                        143.45,
                        253.1,
                        144.83,
                        221.38,
                        146.21,
                        199.31,
                        157.24,
                        184.14,
                        172.41,
                        160.69,
                        182.07,
                        155.17,
                        200,
                        149.66,
                        219.31,
                        142.76,
                        234.48,
                        141.38,
                        266.21,
                        149.66,
                        277.24,
                        163.45,
                        284.14,
                        171.72,
                        297.93,
                        195.17,
                        307.59,
                        215.86,
                        317.24,
                        248.97,
                        320,
                        277.93,
                        318.62,
                        293.1,
                        321.38,
                        306.9,
                        342.07,
                        323.45,
                        360,
                        353.79,
                        365.52,
                        371.72,
                        364.14,
                        393.79,
                        354.48,
                        406.21,
                        342.07,
                        413.1,
                        324.14,
                        417.24,
                        303.45,
                        420,
                        303.45,
                        420,
                        303.45,
                        421.38,
                        296.55,
                        411.72,
                        288.28,
                        370.34,
                        286.9,
                        366.21,
                        245.52,
                        362.07,
                        219.31,
                        371.72,
                        206.9,
                        384.14,
                        194.48,
                        400.69,
                        175.17,
                        415.86,
                        172.41,
                        439.31,
                        168.28,
                        457.24,
                        155.86,
                        462.76,
                        143.45,
                        448.97,
                        133.79,
                        440.69,
                        129.66,
                        437.93,
                    ]
                ],
                "num_keypoints": 10,
                "area": 53450.44955,
                "iscrowd": 0,
                "keypoints": [
                    262,
                    354,
                    2,
                    282,
                    320,
                    2,
                    234,
                    329,
                    2,
                    0,
                    0,
                    0,
                    176,
                    292,
                    2,
                    305,
                    328,
                    2,
                    128,
                    338,
                    2,
                    340,
                    386,
                    2,
                    92,
                    409,
                    2,
                    323,
                    385,
                    2,
                    122,
                    409,
                    2,
                    0,
                    0,
                    0,
                    0,
                    0,
                    0,
                    0,
                    0,
                    0,
                    0,
                    0,
                    0,
                    0,
                    0,
                    0,
                    0,
                    0,
                    0,
                ],
                "bbox": [64.83, 141.38, 300.69, 321.38],
            },
        ],
        "images": [
            {
                "id": 1,
                "height": 427,
                "width": 640,
            },
        ],
        "categories": [{"id": 1}, {"id": 2}, {"id": 3}, {"id": 4}, {"id": 5}],
    }


@fixture(scope="session")
def dataset_keypoint_dt() -> dict:
    return {
        "annotations": [
            {
                "id": 1,
                "image_id": 1,
                "category_id": 4,
                "segmentation": [
                    [
                        135.17,
                        444.83,
                        113.1,
                        435.17,
                        100.69,
                        439.31,
                        96.55,
                        436.31,
                        75.86,
                        431.03,
                        71.72,
                        426.28,
                        70.34,
                        396.55,
                        64.83,
                        356.55,
                        85.66,
                        338.62,
                        109.83,
                        315.41,
                        129.9,
                        291.72,
                        143.45,
                        255.1,
                        144.83,
                        221.38,
                        149.21,
                        196.31,
                        157.24,
                        184.14,
                        175.41,
                        160.69,
                        182.07,
                        155.17,
                        200,
                        140.66,
                        219.31,
                        142.76,
                        239.48,
                        141.38,
                        266.21,
                        149.66,
                        277.24,
                        163.45,
                        284.14,
                        175.72,
                        287.93,
                        195.17,
                        307.59,
                        215.86,
                        317.24,
                        248.97,
                        320,
                        277.93,
                        318.62,
                        293.1,
                        326.38,
                        306.9,
                        342.07,
                        323.45,
                        360,
                        353.79,
                        369.52,
                        371.72,
                        364.14,
                        393.79,
                        354.48,
                        406.21,
                        342.07,
                        413.1,
                        324.14,
                        417.24,
                        303.45,
                        420,
                        303.45,
                        420,
                        303.45,
                        421.38,
                        296.55,
                        419.72,
                        288.28,
                        370.34,
                        286.9,
                        366.21,
                        249.52,
                        362.07,
                        219.31,
                        371.72,
                        206.9,
                        384.14,
                        194.48,
                        400.69,
                        175.17,
                        415.86,
                        172.41,
                        439.31,
                        168.28,
                        457.24,
                        159.86,
                        462.76,
                        143.45,
                        448.97,
                        139.79,
                        440.69,
                        135.66,
                        437.93,
                    ]
                ],
                "num_keypoints": 10,
                "area": 53480.44955,
                "iscrowd": 0,
                "keypoints": [
                    265,
                    354,
                    5,
                    289,
                    339,
                    2,
                    239,
                    335,
                    2,
                    10,
                    10,
                    4,
                    186,
                    294,
                    5,
                    305,
                    328,
                    2,
                    129,
                    345,
                    4,
                    349,
                    389,
                    2,
                    92,
                    403,
                    4,
                    333,
                    389,
                    4,
                    129,
                    419,
                    2,
                    0,
                    0,
                    0,
                    0,
                    0,
                    0,
                    0,
                    0,
                    0,
                    0,
                    0,
                    0,
                    0,
                    0,
                    0,
                    0,
                    0,
                    0,
                ],
                "bbox": [61.83, 146.38, 341.69, 325.38],
                "score": 0.5,
            },
        ],
        "images": [
            {
                "id": 1,
                "height": 427,
                "width": 640,
            },
        ],
        "categories": [{"id": 1}, {"id": 2}, {"id": 3}, {"id": 4}, {"id": 5}],
    }


# COCO


@fixture(scope="session")
def coco_object_gt_np(dataset_object_gt: dict) -> COCOnp:
    coco = COCOnp()
    coco.dataset = dataset_object_gt  # pyright: ignore[reportAttributeAccessIssue]
    coco.createIndex()
    return coco


@fixture(scope="session")
def coco_object_dt_np(dataset_object_dt: dict) -> COCOnp:
    coco = COCOnp()
    coco.dataset = dataset_object_dt  # pyright: ignore[reportAttributeAccessIssue]
    coco.createIndex()
    return coco


@fixture(scope="session")
def coco_keypoint_gt_np(dataset_keypoint_gt: dict) -> COCOnp:
    coco = COCOnp()
    coco.dataset = dataset_keypoint_gt  # pyright: ignore[reportAttributeAccessIssue]
    coco.createIndex()
    return coco


@fixture(scope="session")
def coco_keypoint_dt_np(dataset_keypoint_dt: dict) -> COCOnp:
    coco = COCOnp()
    coco.dataset = dataset_keypoint_dt  # pyright: ignore[reportAttributeAccessIssue]
    coco.createIndex()
    return coco


@fixture(scope="session")
def coco_object_gt_pt(dataset_object_gt: dict) -> COCOpt:
    coco = COCOpt(enable_logging=False)
    coco.dataset = CocoDetectionDataset.from_dict(dataset_object_gt)
    coco.createIndex()
    return coco


@fixture(scope="session")
def coco_object_dt_pt(dataset_object_dt: dict) -> COCOpt:
    coco = COCOpt(enable_logging=False)
    coco.dataset = CocoDetectionDataset.from_dict(dataset_object_dt)
    coco.createIndex()
    return coco


@fixture(scope="session")
def coco_keypoint_gt_pt(dataset_keypoint_gt: dict) -> COCOpt:
    coco = COCOpt(enable_logging=False)
    coco.dataset = CocoDetectionDataset.from_dict(dataset_keypoint_gt)
    coco.createIndex()
    return coco


@fixture(scope="session")
def coco_keypoint_dt_pt(dataset_keypoint_dt: dict) -> COCOpt:
    coco = COCOpt(enable_logging=False)
    coco.dataset = CocoDetectionDataset.from_dict(dataset_keypoint_dt)
    coco.createIndex()
    return coco


# COCO Eval


@fixture(scope="session")
def eval_bbox_np(coco_object_gt_np: COCOnp, coco_object_dt_np: COCOnp) -> COCOevalnp:
    eval = COCOevalnp(coco_object_gt_np, coco_object_dt_np, "bbox")
    eval._prepare()  # pyright: ignore[reportAttributeAccessIssue]
    return eval


@fixture(scope="session")
def eval_bbox_pt(coco_object_gt_pt: COCOpt, coco_object_dt_pt: COCOpt) -> COCOevalpt:
    eval = COCOevalpt(coco_object_gt_pt, coco_object_dt_pt, "bbox", enable_logging=False)
    eval._prepare()
    return eval


@fixture(scope="session")
def eval_segm_np(coco_object_gt_np: COCOnp, coco_object_dt_np: COCOnp) -> COCOevalnp:
    eval = COCOevalnp(coco_object_gt_np, coco_object_dt_np, "segm")
    eval._prepare()  # pyright: ignore[reportAttributeAccessIssue]
    return eval


@fixture(scope="session")
def eval_segm_pt(coco_object_gt_pt: COCOpt, coco_object_dt_pt: COCOpt) -> COCOevalpt:
    eval = COCOevalpt(coco_object_gt_pt, coco_object_dt_pt, "segm", enable_logging=False)
    eval._prepare()
    return eval


@fixture(scope="session")
def eval_keypoints_np(coco_keypoint_gt_np: COCOnp, coco_keypoint_dt_np: COCOnp) -> COCOevalnp:
    eval = COCOevalnp(coco_keypoint_gt_np, coco_keypoint_dt_np, "keypoints")
    eval._prepare()  # pyright: ignore[reportAttributeAccessIssue]
    return eval


@fixture(scope="session")
def eval_keypoints_pt(coco_keypoint_gt_pt: COCOpt, coco_keypoint_dt_pt: COCOpt) -> COCOevalpt:
    eval = COCOevalpt(coco_keypoint_gt_pt, coco_keypoint_dt_pt, "keypoints", enable_logging=False)
    eval._prepare()
    return eval
